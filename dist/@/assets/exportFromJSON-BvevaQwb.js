function v(e){return Object.prototype.toString.call(e)==="[object Array]"}function j(e,a){if(!e)throw new Error(a)}function A(e){return Object.keys(e)}function x(e){return Object.keys(e).map(function(a){return[a,e[a]]})}function m(e,a,t){var r="."+a,n=new RegExp("(\\".concat(a,")?$"));return t(e).replace(n,r)}function z(e){return e.replace(/[^_a-zA-Z 0-9:\-\.]/g,"").replace(/^([ 0-9-:\-\.]|(xml))+/i,"").replace(/ +/g,"-")}function W(e){return Array(e+1).join(" ")}function Y(e){return e.replace(/([<>&])/g,function(a,t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return""}})}function H(e,a,t){switch(a){case"txt":{var r="text/plain;charset=utf-8";return t?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e)}case"css":{var r="text/css;charset=utf-8";return t?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e)}case"html":{var r="text/html;charset=utf-8";return t?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e)}case"json":{var r="text/json;charset=utf-8";return t?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e)}case"csv":{var r="text/csv;charset=utf-8";return t?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e)}case"xls":{var r="text/application/vnd.ms-excel;charset=utf-8";return t?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e)}case"xml":{var r="text/application/xml;charset=utf-8";return t?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e)}default:return""}}function M(e,a,t,r){t===void 0&&(t="download"),r===void 0&&(r=!0);var n=H(e,a,r),c=document.createElement("a");c.href=n,c.download=t,c.setAttribute("style","visibility:hidden"),document.body.appendChild(c),c.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!1,view:window})),document.body.removeChild(c)}var s=function(){return s=Object.assign||function(e){for(var a,t=1,r=arguments.length;t<r;t++){a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},s.apply(this,arguments)},y=function(e,a){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var r=t.call(e),n,c=[],o;try{for(;(a===void 0||a-- >0)&&!(n=r.next()).done;)c.push(n.value)}catch(i){o={error:i}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return c};function K(e){if(!e||v(e)&&!e.length||!v(e)&&!A(e).length)return function(t){return t};var a=v(e)?e.reduce(function(t,r){var n;return s(s({},t),(n={},n[r]=r,n))},Object.create(null)):e;return function(t){return v(t)?t.map(function(r){return x(r).reduce(function(n,c){var o=y(c,2),i=o[0],u=o[1];return i in a&&(n[a[i]]=u),n},Object.create(null))}).filter(function(r){return A(r).length}):x(t).reduce(function(r,n){var c=y(n,2),o=c[0],i=c[1];return o in a&&(r[a[o]]=i),r},Object.create(null))}}function B(e){var a="Invalid export data. Please provide a valid JSON";try{return typeof e=="string"?JSON.parse(e):e}catch{throw new Error(a)}}function Z(e,a,t){a===void 0&&(a=null);var r="Invalid export data. Please provide valid JSON object";try{return JSON.stringify(e,a,t)}catch{throw new Error(r)}}function C(e){return e.map(x).reduce(function(a,t,r){return t.reduce(function(n,c){var o=y(c,2),i=o[0],u=o[1],l=n[i]||Array.from({length:e.length}).map(function(f){return""});return l[r]=(typeof u!="string"?JSON.stringify(u):u)||"",n[i]=l,n},a)},Object.create(null))}function D(e,a){return a===void 0&&(a=function(t){return t}),a(x(e).map(function(t){var r=y(t,2),n=r[0],c=r[1];return{fieldName:n,fieldValues:c}}))}function $(e,a){var t=new RegExp("".concat(a,`|"|
`)),r=t.test(e)?'"':"",n=e.replace(/"/g,'""');return"".concat(r).concat(n).concat(r)}var q={beforeTableEncode:function(e){return e},delimiter:","};function Q(e,a){a===void 0&&(a={});var t=s(s({},q),a),r=t.beforeTableEncode,n=t.delimiter;if(!e.length)return"";var c=C(e),o=D(c,r),i=o.map(function(f){var d=f.fieldName;return d}).join(n)+`\r
`,u=o.map(function(f){var d=f.fieldValues;return d}).map(function(f){return f.map(function(d){return $(d,n)})}),l=u.reduce(function(f,d){return f.map(function(w,_){return"".concat(w).concat(n).concat(d[_])})});return i+l.join(`\r
`)}function ee(e,a){j(e.length>0);var t=C(e),r=D(t,a),n=r.map(function(i){var u=i.fieldName;return u}).join("</b></th><th><b>"),c=r.map(function(i){var u=i.fieldValues;return u}).map(function(i){return i.map(function(u){return"<td>".concat(u,"</td>")})}),o=c.reduce(function(i,u){return i.map(function(l,f){return"".concat(l).concat(u[f])})});return`
    <table>
      <thead>
        <tr><th><b>`.concat(n,`</b></th></tr>
      </thead>
      <tbody>
        <tr>`).concat(o.join(`</tr>
        <tr>`),`</tr>
      </tbody>
    </table>
  `)}var re={beforeTableEncode:function(e){return e}};function te(e,a){var t=s(s({},re),a).beforeTableEncode;if(!e.length)return"";var r=`<html>
  <head>
    <meta charset="UTF-8" />
  </head >
  <body>
    `.concat(ee(e,t),`
  </body>
</html >
`);return r}function ne(e){var a=`<?xml version="1.0" encoding="utf-8"?><!DOCTYPE base>
`.concat(O(e,"base"),`
`);return a}function O(e,a,t,r){t===void 0&&(t="element"),r===void 0&&(r=0);var n=z(a),c=W(r);if(e==null)return"".concat(c,"<").concat(n," />");var o=v(e)?e.map(function(u){return O(u,t,t,r+2)}).join(`
`):typeof e=="object"?x(e).map(function(u){var l=y(u,2),f=l[0],d=l[1];return O(d,f,t,r+2)}).join(`
`):c+"  "+Y(String(e)),i="".concat(c,"<").concat(n,`>
`).concat(o,`
`).concat(c,"</").concat(n,">");return i}var ae={txt:"txt",css:"css",html:"html",json:"json",csv:"csv",xls:"xls",xml:"xml"};function F(e){var a=e.data,t=e.fileName,r=t===void 0?"download":t,n=e.extension,c=e.fileNameFormatter,o=c===void 0?function(g){return g.replace(/\s+/,"_")}:c,i=e.fields,u=e.exportType,l=u===void 0?"txt":u,f=e.replacer,d=f===void 0?null:f,w=e.space,_=w===void 0?4:w,E=e.processor,p=E===void 0?M:E,S=e.withBOM,V=S===void 0?!1:S,L=e.beforeTableEncode,R=L===void 0?function(g){return g}:L,U=e.delimiter,J=U===void 0?",":U,N="Invalid export data. Please provide an array of objects",P="Can't export unknown data type ".concat(l,"."),k="Can't export string data to ".concat(l,".");if(typeof a=="string")switch(l){case"txt":case"css":case"html":return p(a,l,m(r,n??l,o));default:throw new Error(k)}var X=K(i),b=X(B(a)),T=Z(b,d,_);switch(l){case"txt":case"css":case"html":return p(T,l,m(r,n??l,o));case"json":return p(T,l,m(r,n??"json",o));case"csv":{j(v(b),N);var G="\uFEFF",I=Q(b,{beforeTableEncode:R,delimiter:J}),h=V?G+I:I;return p(h,l,m(r,n??"csv",o))}case"xls":{j(v(b),N);var h=te(b,{beforeTableEncode:R});return p(h,l,m(r,n??"xls",o))}case"xml":{var h=ne(b);return p(h,l,m(r,n??"xml",o))}default:throw new Error(P)}}F.types=ae;F.processors={downloadFile:M};export{F as e};
