import{j as e,f as l,t as B,k as K,r as y,S as I,i as J}from"./index-D5MxA1od.js";import{u as R,i as Q,e as W,f as X,g as Y}from"./Layout-DbgPFayI.js";import{u as M}from"./useAsync-xvzxQZ3h.js";import{u as E,M as L}from"./DrawerButton-BkpV-hZI.js";import{U as ee}from"./UploadMany-DiID2Pj1.js";import{T as se,N as le}from"./NotFound-Dz2tSxuD.js";import{a as te,P as O,c as ae,C as ie}from"./ProductServices-CWHNXDdP.js";import{P as re}from"./PageTitle-DwbeqDff.js";import{P as _}from"./ProductDrawer-n_vY7rse.js";import{C as V,S as ne,B as oe}from"./BulkActionDrawer-B99pGRzW.js";import{D as H,E as de}from"./Title-3MS3Jt8b.js";import{a as U,n as v}from"./toast-CC0M9tzZ.js";import{u as ce}from"./useDisableForDemo-PELIHLpC.js";import{T as xe}from"./TableLoading-BNkh70g_.js";import{A as me}from"./AnimatedContent-BEAbhOGX.js";import"./iconBase-D3C_Pjot.js";import"./spinner-CkndCogW.js";import"./exportFromJSON-BvevaQwb.js";import"./react-tooltip.min-BVo38yGE.js";import"./index-qSy3_8G1.js";import"./index-D4GCeWMJ.js";import"./index-aUUiDGWv.js";import"./index.esm-ZPkkcAzd.js";import"./InputArea-CNMSGC1q.js";import"./LabelArea-ZkaCJrp3.js";import"./InputValue-CnylPIOZ.js";import"./useTranslationValue-DGDXwxQa.js";import"./Uploader-Coozl85T.js";import"./_commonjs-dynamic-modules-DcOsajtj.js";import"./index.prod-C1XBFN6V.js";import"./CouponServices-CylhXyRx.js";import"./CurrencyServices-DSarpw9a.js";import"./SwitchToggle-CLXbLkMD.js";import"./AdminServices-B0AmVkZ6.js";import"./SelectLanguageTwo-C7Uu99KD.js";const ge=({products:h,isCheck:r,setIsCheck:g})=>{const{title:u,serviceId:c,handleModalOpen:t,handleUpdate:N}=E(),{currency:f,showingTranslateValue:j,getNumberTwo:b}=R();console.log(h);const T=s=>{const{id:p,checked:w}=s.target;g([...r,p]),w||g(r.filter(C=>C!==p))};return e.jsxs(e.Fragment,{children:[(r==null?void 0:r.length)<1&&e.jsx(H,{id:c,title:u}),(r==null?void 0:r.length)<2&&e.jsx(L,{children:e.jsx(_,{currency:f,id:c})}),e.jsx(l.TableBody,{children:h==null?void 0:h.map((s,p)=>{var w,C,P,D,a,x,m;return e.jsxs(l.TableRow,{children:[e.jsx(l.TableCell,{children:e.jsx(V,{type:"checkbox",name:(w=s==null?void 0:s.title)==null?void 0:w.en,id:s==null?void 0:s.id,handleClick:T,isChecked:r==null?void 0:r.includes(s==null?void 0:s.id)})}),e.jsx(l.TableCell,{children:e.jsxs("div",{className:"flex items-center",children:[s!=null&&s.image[0]?e.jsx(l.Avatar,{className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none",src:s==null?void 0:s.image[0],alt:"product"}):e.jsx(l.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product"}),e.jsx("div",{children:e.jsx("h2",{className:`text-sm font-medium ${(s==null?void 0:s.title.length)>30?"wrap-long-title":""}`,children:(C=j(s==null?void 0:s.title))==null?void 0:C.substring(0,28)})})]})}),e.jsx(l.TableCell,{children:e.jsx("span",{className:"text-sm",children:j((P=s==null?void 0:s.category)==null?void 0:P.name)})}),e.jsx(l.TableCell,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[f,s!=null&&s.isCombination?b((D=s==null?void 0:s.variants[0])==null?void 0:D.originalPrice):b((a=s==null?void 0:s.prices)==null?void 0:a.originalPrice)]})}),e.jsx(l.TableCell,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[f,s!=null&&s.isCombination?b((x=s==null?void 0:s.variants[0])==null?void 0:x.price):b((m=s==null?void 0:s.prices)==null?void 0:m.price)]})}),e.jsx(l.TableCell,{children:e.jsx("span",{className:"text-sm",children:s==null?void 0:s.stock})}),e.jsx(l.TableCell,{children:s.stock>0?e.jsx(l.Badge,{type:"success",children:B("Selling")}):e.jsx(l.Badge,{type:"danger",children:B("SoldOut")})}),e.jsx(l.TableCell,{children:e.jsx(K,{to:`/product/${s._id}`,className:"flex justify-center text-gray-400 hover:text-emerald-600",children:e.jsx(se,{id:"view",Icon:Q,title:B("DetailsTbl"),bgColor:"#10B981"})})}),e.jsx(l.TableCell,{className:"text-center",children:e.jsx(ne,{id:s._id,status:s.status})}),e.jsx(l.TableCell,{children:e.jsx(de,{id:s==null?void 0:s.id,product:s,isCheck:r,handleUpdate:N,handleModalOpen:t,title:j(s==null?void 0:s.title)})})]},p+1)})})]})},he={type:"object",properties:{categories:{type:"array"},image:{type:"array"},tag:{type:"array"},variants:{type:"array"},show:{type:"array"},status:{type:"string"},prices:{type:"object"},isCombination:{type:"boolean"},title:{type:"object"},productId:{type:"string"},slug:{type:"string"},category:{type:"object"},stock:{type:"number"},description:{type:"object"}},required:["categories","category","prices","title"]},je=h=>{const r=new te({allErrors:!0}),{setLoading:g,setIsUpdate:u}=y.useContext(I),[c]=y.useState([]),[t,N]=y.useState([]),[f,j]=y.useState(""),[b,T]=y.useState(!1),{handleDisableForDemo:s}=ce();return{data:h,filename:f,isDisabled:b,handleSelectFile:async x=>{var F;x.preventDefault();const m=new FileReader,i=(F=x.target)==null?void 0:F.files[0];i&&i.type==="application/json"?(j(i==null?void 0:i.name),T(!0),m.readAsText(i,"UTF-8"),m.onload=n=>{const A=JSON.parse(n.target.result).map(o=>({categories:o.categories,image:o.image,barcode:o.barcode,tag:o.tag,variants:o.variants,status:o.status,prices:o.prices,isCombination:JSON.parse(o.isCombination.toLowerCase()),title:o.title,productId:o.productId,slug:o.slug,sku:o.sku,category:o.category,stock:o.stock,description:o.description}));N(A)}):i&&i.type==="text/csv"?(j(i==null?void 0:i.name),T(!0),m.onload=async n=>{const S=n.target.result,o=(await ae().fromString(S)).map(d=>({categories:JSON.parse(d.categories),image:JSON.parse(d.image),barcode:d.barcode,tag:JSON.parse(d.tag),variants:JSON.parse(d.variants),status:d.status,prices:JSON.parse(d.prices),isCombination:JSON.parse(d.isCombination.toLowerCase()),title:JSON.parse(d.title),productId:d.productId,slug:d.slug,sku:d.sku,category:JSON.parse(d.category),stock:JSON.parse(d.stock),description:JSON.parse(d.description)}));N(o)},m.readAsText(i)):(j(i==null?void 0:i.name),T(!0),v("Unsupported file type!"))},serviceData:h,handleOnDrop:x=>{for(let m=0;m<x.length;m++)c.push(x[m].data)},handleUploadProducts:()=>{if(!s())if(c.length<1)v("Please upload/select csv file first!");else{if(s())return;O.addAllProducts(c).then(x=>{U(x.message)}).catch(x=>v(x.message))}},handleRemoveSelectFile:x=>{j(""),N([]),setTimeout(()=>T(!1),1e3)},handleUploadMultiple:x=>{if(!s())if(t.length>1){g(!0);let m=t.map(n=>r.validate(he,n));const i=n=>n===!0;m.every(i)?O.addAllProducts(t).then(n=>{u(!0),g(!1),U(n.message)}).catch(n=>{g(!1),v(n.message)}):(g(!1),v("Please enter valid data!"))}else g(!1),v("Please select a valid json, csv & xls file first!")}}},fe=({setCategory:h})=>{const{t:r}=J(),{data:g}=M(ie.getAllCategories),{showingTranslateValue:u}=R();return e.jsx(e.Fragment,{children:e.jsxs(l.Select,{onChange:c=>h(c.target.value),children:[e.jsx("option",{value:"All",defaultValue:!0,hidden:!0,children:r("Category")}),g==null?void 0:g.map(c=>e.jsx("option",{value:c._id,children:u(c==null?void 0:c.name)},c._id))]})})},Xe=()=>{const{title:h,allId:r,serviceId:g,handleDeleteMany:u,handleUpdateMany:c}=E(),{t}=J(),{toggleDrawer:N,lang:f,currentPage:j,handleChangePage:b,searchText:T,setCategory:s,searchRef:p,handleSubmitForAll:w,sortedField:C,setSortedField:P,limitData:D}=y.useContext(I),{data:a,loading:x,error:m}=M(()=>O.getAllProducts({}));console.log("product page",a==null?void 0:a.rows);const[i,F]=y.useState(!1),[n,S]=y.useState([]),A=()=>{F(!i),S(a==null?void 0:a.products.map(k=>k._id)),i&&S([])},o=()=>{s(""),P(""),p.current.value=""},{serviceData:d,filename:$,isDisabled:q,handleSelectFile:Z,handleUploadMultiple:z,handleRemoveSelectFile:G}=je(a==null?void 0:a.products);return e.jsxs(e.Fragment,{children:[e.jsx(re,{children:t("ProductsPage")}),e.jsx(H,{ids:r,setIsCheck:S,title:h}),e.jsx(oe,{ids:r,title:"Products"}),e.jsx(L,{children:e.jsx(_,{id:g})}),e.jsxs(me,{children:[e.jsx(l.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(l.CardBody,{className:"",children:e.jsxs("form",{onSubmit:w,className:"py-3 md:pb-0 grid gap-4 lg:gap-6 xl:gap-6 xl:flex",children:[e.jsx("div",{className:"flex-grow-0 sm:flex-grow md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(ee,{title:"Products",filename:$,isDisabled:q,totalDoc:a==null?void 0:a.totalDoc,handleSelectFile:Z,handleUploadMultiple:z,handleRemoveSelectFile:G})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(l.Button,{disabled:n.length<1,onClick:()=>c(n),className:"w-full rounded-md h-12 btn-gray text-gray-600",children:[e.jsx("span",{className:"mr-2",children:e.jsx(W,{})}),t("BulkAction")]})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(l.Button,{disabled:(n==null?void 0:n.length)<1,onClick:()=>u(n,a.products),className:"w-full rounded-md h-12 bg-red-300 disabled btn-red",children:[e.jsx("span",{className:"mr-2",children:e.jsx(X,{})}),t("Delete")]})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(l.Button,{onClick:N,className:"w-full rounded-md h-12",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Y,{})}),t("AddProduct")]})})]})]})})}),e.jsx(l.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsx(l.CardBody,{children:e.jsxs("form",{onSubmit:w,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:[e.jsxs("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx(l.Input,{ref:p,type:"search",name:"search",placeholder:"Search Product"}),e.jsx("button",{type:"submit",className:"absolute right-0 top-0 mt-5 mr-1"})]}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(fe,{setCategory:s,lang:f})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(l.Select,{onChange:k=>P(k.target.value),children:[e.jsx("option",{value:"All",defaultValue:!0,hidden:!0,children:t("Price")}),e.jsx("option",{value:"low",children:t("LowtoHigh")}),e.jsx("option",{value:"high",children:t("HightoLow")}),e.jsx("option",{value:"published",children:t("Published")}),e.jsx("option",{value:"unPublished",children:t("Unpublished")}),e.jsx("option",{value:"status-selling",children:t("StatusSelling")}),e.jsx("option",{value:"status-out-of-stock",children:t("StatusStock")}),e.jsx("option",{value:"date-added-asc",children:t("DateAddedAsc")}),e.jsx("option",{value:"date-added-desc",children:t("DateAddedDesc")}),e.jsx("option",{value:"date-updated-asc",children:t("DateUpdatedAsc")}),e.jsx("option",{value:"date-updated-desc",children:t("DateUpdatedDesc")})]})}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx("div",{className:"w-full mx-1",children:e.jsx(l.Button,{type:"submit",className:"h-12 w-full bg-emerald-700",children:"Filter"})}),e.jsx("div",{className:"w-full mx-1",children:e.jsx(l.Button,{layout:"outline",onClick:o,type:"reset",className:"px-4 md:py-1 py-2 h-12 text-sm dark:bg-gray-700",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Reset"})})})]})]})})})]}),x?e.jsx(xe,{row:12,col:7,width:160,height:20}):m?e.jsx("span",{className:"text-center mx-auto text-red-500",children:m}):(d==null?void 0:d.length)!==0?e.jsxs(l.TableContainer,{className:"mb-8 rounded-b-lg",children:[e.jsxs(l.Table,{children:[e.jsx(l.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(l.TableCell,{children:e.jsx(V,{type:"checkbox",name:"selectAll",id:"selectAll",isChecked:i,handleClick:A})}),e.jsx(l.TableCell,{children:t("ProductNameTbl")}),e.jsx(l.TableCell,{children:t("CategoryTbl")}),e.jsx(l.TableCell,{children:t("PriceTbl")}),e.jsx(l.TableCell,{children:"Sale Price"}),e.jsx(l.TableCell,{children:t("StockTbl")}),e.jsx(l.TableCell,{children:t("StatusTbl")}),e.jsx(l.TableCell,{className:"text-center",children:t("DetailsTbl")}),e.jsx(l.TableCell,{className:"text-center",children:t("PublishedTbl")}),e.jsx(l.TableCell,{className:"text-right",children:t("ActionsTbl")})]})}),e.jsx(ge,{lang:f,isCheck:n,products:a==null?void 0:a.rows,setIsCheck:S})]}),e.jsx(l.TableFooter,{children:e.jsx(l.Pagination,{totalResults:a==null?void 0:a.totalDoc,resultsPerPage:D,onChange:b,label:"Product Page Navigation"})})]}):e.jsx(le,{title:"Product"})]})};export{Xe as default};
